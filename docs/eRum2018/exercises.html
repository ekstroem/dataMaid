<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Exercises</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data Screening</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="slides.html">Slides</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exercises.html">Exercises</a>
    </li>
    <li>
      <a href="exercises_solutions.html">Solutions for exercises</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Exercises</h1>

</div>


<div id="exercise-1" class="section level1">
<h1>Exercise 1</h1>
<p>For this initial exercise we will be trying to identify errors in a data frame containing information about the US presidents. First we install the packages needed to get the dataset that we will be working with. If you have already installed <code>dataMaid</code> from home, you can skip this step.</p>
<pre class="r"><code>install.packages(&quot;dataMaid&quot;)</code></pre>
<p>Now we have installed the <code>dataMaid</code> package which contains the raw dataset, <code>presiData</code>. We can see the first couple of rows of the dataset with the <code>head</code> command.</p>
<pre class="r"><code>library(&quot;dataMaid&quot;)
load(url(&quot;http://biostatistics.dk/eRum2018/data/presiData.rda&quot;))
head(presiData)</code></pre>
<pre><code>##     lastName firstName orderOfPresidency   birthday dateOfDeath
## 10     Tyler      John                10 1790-03-29  1862-01-18
## 2      Adams      John                 2 1735-10-30  1826-07-04
## 25  McKinley   William                25 1843-01-29  1901-09-14
## 32 Roosevelt  Franklin                32 1882-01-30  1945-04-12
## 14    Pierce  Franklin                14 1804-11-03  1869-10-08
## 24 Cleveland    Grover                24 1837-03-18  1908-06-24
##     stateOfBirth assassinationAttempt  sex ethnicity presidencyYears
## 10      Virginia                    0 Male Caucasian               3
## 2  Massachusetts                    0 Male Caucasian               3
## 25          Ohio                    1 Male Caucasian               4
## 32      New York                    1 Male Caucasian              12
## 14 New Hampshire                    0 Male Caucasian               4
## 24    New Jersey                    0 Male Caucasian               4
##    ageAtInauguration favoriteNumber
## 10                51           1+0i
## 2                 61           4+0i
## 25                54           3+0i
## 32                51           6+0i
## 14                48           4+0i
## 24                55           2+0i</code></pre>
<p>We are being told by our research collaborators that the dataset should contain information on 11 variables relates to the US presidents. The variables are</p>
<ul>
<li><code>lastName</code> The surname of the president.</li>
<li><code>firstName</code> The first name of the president.</li>
<li><code>orderOfPresidency</code> A factor variable indicating the order of the presidents (with George Washington as number 1 and Donald Trump as number 45).</li>
<li><code>birthday</code> The date of birth of the president.</li>
<li><code>dateOfDeath</code> The date of death of the president.</li>
<li><code>stateOfBirth</code> A character variable with the state in which the president was born.</li>
<li><code>assassinationAttempt</code> A text variable indicating whether there was an assassination attempt (1) or not (0) on the president.</li>
<li><code>sex</code> A factor variable with the sex of the president.</li>
<li><code>ethnicity</code> A factor variable with the ethnicity of the president.</li>
<li><code>presidencyYears</code> A numeric variable with the duration of the presidency, in years.</li>
<li><code>ageAtInauguration</code> the age at inauguration.</li>
<li><code>favoriteNumber</code> A complex type variable with a fictional favorite number for each president.</li>
</ul>
<p>Try to find and document as many errors are you can in the <code>presiData</code>. In particular focus on validity (conforms to the correct syntax with the right format, type, and range), on consistency, accuracy, and uniqueness.</p>
<p>[Hint: If you are new to R then you can use the functions <code>str</code>, <code>print</code> and the <code>$</code> operator to extract variables from the data frame.]</p>
</div>
<div id="exercise-2" class="section level1">
<h1>Exercise 2</h1>
<p>Here we will use the <code>dataMaid</code> package <code>makeDataReport()</code> to screen data for obvious and non-obvious errors in the dataset. We will continue working on the <code>presiData</code> from the <code>dataMaid</code> package in order to find errors that we previously missed.</p>
<p>Note that exercise 2 contains a lot of exercises. We do not expect you to be able to solve all of them in the time given. Remember the primary focus is to identify potential errors in the dataset.</p>
<ol style="list-style-type: decimal">
<li><p>Run the <code>makeDataReport()</code> function to make your own report for the <code>presiData</code> and look through it. What legitimate errors are found? What warnings are unnecessary?</p></li>
<li><p>Start by verifying the validity of the data (format, type, and range). When <code>dataMaid</code> encounters a variable type that is unknown then it prints a note and skips the variable. If we want to perform specific checks for a variable with an unknown type then we must fix the <code>class</code> in the data frame (when relevant) or alternatively force <code>dataMaid</code> to consider a specific class as if it were another class.</p>
<p>Handle the unusual variable class used for the variables <code>lastName</code> and <code>firstName</code> by changing their classes to something more standard. This can be done using the code</p>
<pre class="r"><code>class(presiData$firstName) &lt;- &quot;character&quot;
class(presiData$lastName) &lt;- &quot;character&quot;</code></pre>
<p>Try calling <code>help(makeDataReport)</code> and look at the documentation for the argument <code>treatXasY</code>. Use this argument in a new call to <code>makeDataReport()</code> so that for example the <code>favoriteNumber</code> variable will be handled like a <code>numeric</code> variable.</p>
<p>[Hint: you may need to use the <code>replace=TRUE</code> argument too to overwrite any previous reports.]</p></li>
</ol>
<p>Note how everything is documented and can be used in collaboration with a research partner.</p>
<p>The argument <code>checks</code> can be used to control which checks are performed for variables of each supported class. The helper function <code>setChecks()</code> makes it easy to add or remove certain checks for certain variable classes while <code>allCheckFunctions()</code> returns an overview of all available checkFunctions to choose from.</p>
<p>The following bit of code shows how to change the choice of checks for <code>numeric</code> variables to <em>not</em> include a check for outliers (i.e. the checkFunction <code>identifyOutliers</code>):</p>
<pre class="r"><code>makeDataReport(presiData, replace = TRUE,
               checks = setChecks(numeric = defaultNumericChecks(remove=&quot;identifyOutliers&quot;)))

#or, by without the use of defaultNumericChecks():
makeDataReport(presiData, replace  = TRUE,
               checks = setChecks(numeric = &quot;identifyMissing&quot;))</code></pre>
<p>Now, it’s your turn to make a <code>makeDataReport()</code> call that does <em>not</em> check whether or not <code>character</code> variables have less than 5 unique levels. You can proceed as follows:</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Use <code>allCheckFunctions()</code> to find out which checkFunction does the check for less than 5 unique values. Check that this function is indeed among the default checkFunctions for <code>character</code> variables by calling <code>defaultCharacterChecks()</code>.</p></li>
<li><p>Use the <code>checks</code> argument, <code>setChecks()</code> and <code>defaultCharacterChecks()</code> to remove the “less than 5 unique values”-check from the checks performed for <code>character</code> variables. Look at the overview table on the first page of your report. Can you find a difference?</p></li>
</ol>
<p>The default plots used in a <code>dataMaid</code> report are made using the <code>ggplot2</code> package. However, you can change the plot style to base <code>R</code> graphics if you please by using the <code>visuals</code> argument in <code>makeDataReport()</code>.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Use <code>allVisualFunctions()</code> to identify the name of the visualFunction that you need to use if you want base R graphics style plots.</p></li>
<li><p>Look at the documentation for <code>setVisuals()</code> e.g. by calling <code>?setVisuals</code>. Here, you see an argument called <code>all</code>. Call <code>setVisuals()</code> in the console using the <code>all</code> argument to specify the <code>graphics</code> style plots. Try also calling <code>setVisuals()</code> with the new function in the <code>factor</code> and <code>character</code> arguments only.</p></li>
<li><p>Use <code>makeDataReport()</code>’s <code>visuals</code> argument and <code>setVisuals()</code> to obtain a data report where <code>character</code> and <code>factor</code> variables use base R graphics plots, while all other variable classes use <code>ggplot2</code> plots.</p></li>
<li><p>The choice of summaries included for each variable class in the report can also be controlled, and the manner in which this is done is very similar to the procedures you have tried for checks and visuals in the above. Experiment with the functions <code>setSummaries()</code>, <code>allSummaryFunctions()</code> and <code>defaultCharacterSummaries()</code> in order to remove “Mode” from the summaries listed for such variables in the data report (using the argument <code>summaries</code>).</p></li>
<li><p>We would now like a report that only displays the results of checks (no visuals or summaries) and only lists variables that actually were found to have potential problems. But for each problem found, we would like to see <em>all</em> problematic values listed, not just the first 10, as is currently the case. Moreover, we would like to rename the report title (as displayed on the front page) to be “Problem flagging report”, and we would also like to have “problemflagging” appended to the file name of the report, so that we can easily tell it apart from the usual data report.</p>
<p>Look at the documentation for <code>makeDataReport()</code> and try to produce the report described here.</p></li>
</ol>
<div id="exercise-2b---using-datamaid-interactively" class="section level2">
<h2>Exercise 2b - using <code>dataMaid</code> interactively</h2>
<p>The primary intent of the <code>dataMaid</code> package is to generate the combined report produced by the <code>makeDataReport()</code>. However, the report generated by <code>makeDataReport()</code> are produced by a series of check, summary, and visualization function that can be called directly. This enables us to work interactively with the functions that are part of the <code>dataMaid</code> package.</p>
<p>Recall that the <code>allCheckFunctions()</code>, <code>allSummaryFunctions()</code>, and <code>allVisualFunctions()</code> show the built-in functions that are used for checks, summaries, and visuals, respectively.</p>
<ol style="list-style-type: decimal">
<li>Run <code>check(presiData$ageAtInauguration)</code>, <code>visualize(presiData$ageAtInauguration)</code>, and <code>summarize(presiData$ageAtInauguration)</code> and verify that you obtain information identical to what you saw in the report previously generated by <code>makeDataReport(presiData)</code>.</li>
</ol>
<p>Look at <code>str(check(presiData$ageAtInauguration))</code>. The <code>check()</code> function returns a list with a length matching the number of checks, and each element is itself a list of length 3 containing information about whether a problem was found, the message that is printed in the report, and the list of observations that gave rise to the problem.</p>
<ol start="2" style="list-style-type: decimal">
<li>Earlier, we saw how we could modify the choice of checks by using the <code>checks</code> argument in combination with the <code>setChecks()</code> function. Modify the manual check for <code>presidencyYears</code> such that it only returns potential outliers.</li>
</ol>
<p>When a particular value is flagged as a potential error we might want to report this back to the data provider so they can verify if the data is correct. In order to do this we need to be able to identify the <em>rows</em> that give rise to these potential problems.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Use <code>check()</code> to identify the values that are thought to be potential outliers for the <code>presidencyYears</code> variable and store the result in an object <code>problems</code>.</p>
<p>Recall that <code>problems</code> consists of a list (of 1 element) of lists. Return the vector with the <code>problemValues</code> and save them to a vector <code>probs</code>. [ Hint: You can reference elements of a list using double square brackets <code>[[]]</code> or the <code>$</code> operator ]</p></li>
<li><p>Use the vector of potential error values to identify the indices (rows) of <code>presiData</code> which contain values for <code>presidencyYears</code> that are part of the vector of problem values, <code>probs</code>. [ Hint: the operator <code>%in%</code> provides a way to return the indices of a vector that contain elements that are found within another vector. ]</p>
<p>Print all the rows that were just identified.</p></li>
</ol>
<p>We can also use <code>check()</code> on a full data frame. This will return a list of lists of lists. We can use this to extract check results across different variables.</p>
<p>For the next 3 questions we will use the <code>toyData</code> dataset.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Run the following two lines to load the <code>toyData</code> dataset and print it</p>
<pre class="r"><code>data(toyData)
toyData</code></pre>
<pre><code>## # A tibble: 15 x 6
##    pill  events region change id    spotifysong
##    &lt;fct&gt;  &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;      
##  1 red        1 a      -0.626 1     Irrelevant 
##  2 red        1 a       0.184 2     Irrelevant 
##  3 red        1 a      -0.836 3     Irrelevant 
##  4 red        2 a       1.60  4     Irrelevant 
##  5 red        2 a       0.330 5     Irrelevant 
##  6 red        6 b      -0.820 6     Irrelevant 
##  7 red        6 b       0.487 7     Irrelevant 
##  8 red        6 b       0.738 8     Irrelevant 
##  9 red      999 c       0.576 9     Irrelevant 
## 10 red       NA c      -0.305 10    Irrelevant 
## 11 blue       4 c       1.51  11    Irrelevant 
## 12 blue      82 .       0.390 12    Irrelevant 
## 13 blue      NA &quot; &quot;    -0.621 13    Irrelevant 
## 14 &lt;NA&gt;     NaN other  -2.21  14    Irrelevant 
## 15 &lt;NA&gt;       5 OTHER   1.12  15    Irrelevant</code></pre></li>
</ol>
<p>We will try to identify <em>all</em> the values found in the dataset that are possible missing values that have been wrongly encoded.</p>
<ol start="6" style="list-style-type: decimal">
<li><p>Do a full <code>check()</code> on the full <code>toyData</code> data frame but only consider the <code>identifyMissing</code> check. [ Hint: Note you can use the <code>all=&quot;identifyMissing&quot;</code> argument to <code>setChecks()</code> as described previously ]</p></li>
<li><p>(Somewhat tricky) Return a vector of values that are potential missing values across the full dataset. [ Hint: You can use <code>sapply()</code> to extract the <code>problemValues</code> for each element in the list, and then wrap it in <code>unlist()</code> to combine it all into a single list.]</p>
<p>This approach is especially useful if you have data in wide format and you want to summarize problem values across different repeats of the same underlying variable (eg, if it is the same value measured over time).</p></li>
</ol>
</div>
<div id="exercise-2c---customizing-new-function" class="section level2">
<h2>Exercise 2c - customizing new function</h2>
<p>Next up is the task of writing custom summaryFunctions and checkFunctions. Note that a complete guide to writing such extensions is available in the vignette: <code>vignette(&quot;extending_dataMaid&quot;)</code>. We do not cover writing visualFunctions in the exercises, but we recommend you to look through the vignette if you are particularly interested in this subject.</p>
<div id="make-a-summaryfunction-refcat" class="section level4">
<h4>Make a summaryFunction: <code>refCat()</code></h4>
<p>First up is building a summaryFunction, <code>refCat()</code>, which will give en reference category for factor variables, i.e. the first level. For instance, for the variable <code>pill</code> in <code>toyData</code>, the reference category is <code>blue</code>:</p>
<pre class="r"><code>library(dataMaid)
toyData$pill</code></pre>
<pre><code>##  [1] red  red  red  red  red  red  red  red  red  red  blue blue blue &lt;NA&gt;
## [15] &lt;NA&gt;
## Levels: blue red</code></pre>
<p>Below, we have provided a template for building <code>refCat()</code> that you can use as a starting point. There are a few points to note about this function:</p>
<ul>
<li>The final call to <code>summaryFunction()</code> changes the class of the output, so that it will be indistinguishable from that of the built-in summaryFunctions.</li>
<li>The list argument used for <code>summaryFunction()</code> has three entries, <code>feature</code>, <code>result</code> and <code>value</code>. In the example below, the contents of <code>result</code> and <code>value</code> are identical, but generally, <code>result</code> should be used for the result one wants printed in the data report, while <code>value</code> is not mandatory, but can be used to store whatever we are summarizing in its original data class.</li>
</ul>
<pre class="r"><code>refCat &lt;- function(v, ...) {
  val &lt;- #the reference category of the variable v
  res &lt;- val
  summaryResult(list(feature = &quot;Reference category&quot;, result = res,
                     value = val))
}</code></pre>
<ol style="list-style-type: decimal">
<li><p>Use the template to finish writing <code>refCat()</code>. Call it on <code>pill</code> from <code>toyData</code> in order to test whether it is working.</p></li>
<li><p>Now, we will add <code>refCat()</code> to <code>dataMaid</code>s known summaryFunctions. First, try calling <code>allSummaryFunctions()</code> to see what summary functions are already available. We want <code>refCat()</code> to be added to the output of this function. This is done by use of <code>summaryFunction()</code>. Fill in the missing pieces in the code below, run it, and try calling <code>allSummaryFunctions()</code> again afterwards.</p></li>
</ol>
<pre class="r"><code>refCat &lt;- summaryFunction(refCat,
  description = #Text describing what the summaryFunction does,
    ,
  classes = c(#[vector of data types that the function is intended for]
    )
  )</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Lastly, we will use <code>refCat()</code> from <code>makeDataReport()</code>. Run the following code bit, adding <code>refCat()</code> to the summaries used for factor variables and look at the result.</li>
</ol>
<pre class="r"><code>makeDataReport(presiData, 
               summaries = setSummaries(factor = defaultFactorSummaries(add = &quot;refCat&quot;)),
               vol = &quot;_withRefCat&quot;)</code></pre>
</div>
<div id="make-a-checkfunction-identifynonstartcase" class="section level4">
<h4>Make a checkFunction: <code>identifyNonStartCase</code></h4>
<p>We will now write a check function that checks whether character variables are written in start case (i.e., “With Capital Letters For Each New Word”). This might be relevant for variables containing names. Again, we give a template below that can be used as a starting point.</p>
<pre class="r"><code>identifyNonStartCase &lt;- function(v, nMax, maxDecimals, ...) {
  
  #do the check
  problemValues &lt;- #vector of values in v that are problematic, i.e. that are not 
    #written in start case. If no problem is encountered, it should be set to NULL
  
  problem &lt;- #is there a problem? TRUE/FALSE
  
  problemStatus &lt;- list(problem = problem,
                        problemValues = problemValues)

  problemMessage &lt;- #Message that is printed prior to listing
                    # problem values in the dataMaid output,
                    # ending with a colon
    
  outMessage &lt;- messageGenerator(problemStatus, problemMessage, nMax)

  checkResult(list(problem = problem,
    message = outMessage,
    problemValues = problemValues))
}

identifyNonStartCase &lt;- checkFunction(identifyNonStartCase,
  description = #Some text describing the checkFunction
    ,
  classes = c(#[the data types that this function is intended to be used for]
    )
)</code></pre>
<p>A few comments for the helper functions seen in the template:</p>
<ul>
<li><code>messageGenerator()</code> helps creating streamlined, properly escaped messages that can be printed in the data report without any problems. It also ommits extra problemValues, if <code>nMax</code> is smaller than the encountered number of problemValues.</li>
<li><code>checkResult()</code> works just like <code>summaryResult()</code> and converts the output class. Note that <code>problemValues</code> must be in their original data class (i.e. the raw values from <code>v</code>), because then the contents of <code>problemValues</code> can be used to identify <em>where</em> problems were found.</li>
<li><code>checkFunction()</code> is also like its <code>summaryFunction</code> cousin mentioned above: It converts the function into a <code>checkFunction</code> and makes sure that it becomes available in a <code>allCheckFunctions()</code> call.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><p>Finish <code>identifyNonStartCase()</code>. A few tips that might be helpful:</p>
<ul>
<li>One strategy for a check like the current one is first manipulating the variable so that it adhers to the check-rule (in this case: is in start case) and secondly, comparing the original version of the variable with the new one. Any entries that differ in the two versions of the variables are then deemed <code>problemValues</code> and the <code>problem</code> indicator must be set to <code>TRUE</code> if <code>length(problemValues &gt; 0)</code>.<br />
</li>
<li><code>strsplit()</code> splits character strings into smaller parts. Try calling it on a character string with <code>split = &quot; &quot;</code>.</li>
<li><code>toupper()</code> and <code>tolower()</code> changes the case for letters to upper- and lower case, respectively.</li>
<li>If you are familiar with regular expressions, this is of course also a very good strategy for identifying non-start case values.</li>
</ul></li>
<li><p>Use <code>identifyNonStartCase()</code> on the variable <code>stateOfBirth</code> from <code>presiData</code>. Try using it on all <code>character</code> variables in <code>presiData</code> by use of the function <code>check()</code>.</p></li>
<li><p>Add <code>identifyNonStartCase()</code> to the checks used on character variables in a <code>makeDataReport()</code> call on <code>presiData</code>. Use the argument <code>vol = &quot;_nonStartCase&quot;</code> to give the new report a different file name than the old ones. Compare the new report with an old version. Can you find the description you wrote for <code>identifyNonStartCase()</code> when calling <code>checkFunction()</code>?</p></li>
</ol>
<hr />
</div>
</div>
</div>
<div id="exercise-3" class="section level1">
<h1>Exercise 3</h1>
<div id="exercise-3a" class="section level2">
<h2>Exercise 3a</h2>
<p>Until now we have identified a number of errors and inconsistencies in the <code>presiData</code>. For each data error you encountered in the above, your should:</p>
<ol style="list-style-type: decimal">
<li>Correct the error</li>
<li>Check the resulting dataset to ensure that you did indeed clean up the data errors.</li>
</ol>
<p>When all the corrections are completed you should be able to run all the error checks from <code>dataMaid</code> and end up without any critical errors.</p>
<p>Remember to follow <strong>rules 1 and 2</strong> and consider how these corrections best are documented.</p>
</div>
<div id="exercise-3b" class="section level2">
<h2>Exercise 3b</h2>
<p>For now we assume that we have a dataset that has been screened and is clean enough to be used for subsequent analyses.</p>
<ol style="list-style-type: decimal">
<li>Use the <code>makeCodebook()</code> function to produce a final codebook that could be passed on as a documentation (of the dataset) for the data analysis.</li>
<li>Use the option to set <code>shortDescription</code> attributes for the dataset to explain that:
<ol style="list-style-type: lower-alpha">
<li>The information in <code>favoriteNumber</code> has been obtained by consulting a Ouija board or - when that failed - just typing in a number and consequently the accuracy may be low.</li>
<li>For <code>assassinationAttempt</code>, 1 means yes and 0 means no</li>
<li>For the <code>firstName</code> it is literally the first name. No middle names or initials. Also try using the <code>label</code> attribute to add some variable labels of your own choosing. Run the codebook command again.</li>
</ol></li>
</ol>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
